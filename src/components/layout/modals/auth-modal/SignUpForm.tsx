"use client";
import { notify } from "@/components/common/toast/Toastify";
import { useAppDispatch } from "@/redux/hooks";
import { changeIsModalAuthVisible } from "@/redux/slices/ui/uiSlice";
import JWT from "@/shared/helper/jwtToken";
import AuthAPI from "@/shared/services/auth";
import { signIn } from "next-auth/react";
import Link from "next/link";
import React, { FC, useState } from "react";

const SignUpForm = () => {
  const [passType, setPassType] = useState("password");

  const dispatch = useAppDispatch();

  const handleSubmit = async (e: any) => {
    e.preventDefault();

    try {
      const data = await AuthAPI.signUp({
        email: e.target.email.value,
        password: e.target.password.value,
        fullName: e.target.username.value,
      });

      JWT.addJwtTokens(data);
      dispatch(changeIsModalAuthVisible(false));
      notify("Uspješna registracija", { type: "success" });
      signIn("credentials", {
        email: e.target.email.value,
        password: e.target.password.value,
        redirect: false,
      });
    } catch (error) {
      if (error instanceof Error && error.message) {
        notify(error.message, { type: "error" });
      }
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      <div className="flex items-center p-1 bg-[#313131] rounded-xl px-3 py-2 gap-3">
        <EmailIcon />
        <input
          type="email"
          placeholder="Email"
          className="bg-transparent text-[#cccccc] outline-none flex-1"
          id="email"
        />
      </div>

      <div className="flex items-center p-1 bg-[#313131] rounded-xl px-3 py-2 gap-3 mt-4">
        <UserIcon />
        <input
          type="text"
          placeholder="Korisničko ime"
          className="bg-transparent text-[#cccccc] outline-none flex-1"
          id="username"
        />
      </div>

      <div className="flex items-center p-1 bg-[#313131] rounded-xl px-3 py-2 gap-3 mt-4">
        <LockIcon />
        <input
          type={passType}
          placeholder="Password"
          className="bg-transparent text-[#cccccc] outline-none flex-1"
          id="password"
        />
        <button
          type="button"
          onClick={() => {
            if (passType === "password") {
              setPassType("text");
            } else {
              setPassType("password");
            }
          }}
        >
          <EyeIcon fill={passType === "password" ? "#999999" : "#3B82F6"} />
        </button>
      </div>

      {/* -------------------------- */}
      <button
        type="submit"
        className="w-full h-12 text-base font-bold bg-[#2463EB] font-exo2 rounded-lg mt-8"
      >
        Kreirajte račun
      </button>

      {/* -------------------------- */}
    </form>
  );
};

const EmailIcon = () => {
  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="16"
      height="16"
      viewBox="0 0 16 16"
      fill="none"
    >
      <path
        d="M12.6667 0.503296H3.33333C2.4496 0.504354 1.60237 0.855884 0.97748 1.48078C0.352588 2.10567 0.00105857 2.9529 0 3.83663L0 11.8366C0.00105857 12.7204 0.352588 13.5676 0.97748 14.1925C1.60237 14.8174 2.4496 15.1689 3.33333 15.17H12.6667C13.5504 15.1689 14.3976 14.8174 15.0225 14.1925C15.6474 13.5676 15.9989 12.7204 16 11.8366V3.83663C15.9989 2.9529 15.6474 2.10567 15.0225 1.48078C14.3976 0.855884 13.5504 0.504354 12.6667 0.503296ZM3.33333 1.83663H12.6667C13.0659 1.83741 13.4557 1.95764 13.786 2.18183C14.1163 2.40602 14.3719 2.72393 14.52 3.09463L9.41467 8.20063C9.03895 8.57484 8.53028 8.78494 8 8.78494C7.46972 8.78494 6.96105 8.57484 6.58533 8.20063L1.48 3.09463C1.6281 2.72393 1.88374 2.40602 2.21403 2.18183C2.54432 1.95764 2.93414 1.83741 3.33333 1.83663ZM12.6667 13.8366H3.33333C2.8029 13.8366 2.29419 13.6259 1.91912 13.2508C1.54405 12.8758 1.33333 12.3671 1.33333 11.8366V4.83663L5.64267 9.1433C6.26842 9.76747 7.11617 10.118 8 10.118C8.88383 10.118 9.73158 9.76747 10.3573 9.1433L14.6667 4.83663V11.8366C14.6667 12.3671 14.456 12.8758 14.0809 13.2508C13.7058 13.6259 13.1971 13.8366 12.6667 13.8366Z"
        fill="#3B82F6"
      />
    </svg>
  );
};
export const LockIcon = () => {
  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="14"
      height="17"
      viewBox="0 0 14 17"
      fill="none"
    >
      <path
        d="M11.6673 6.45267V5.50334C11.6673 4.26566 11.1757 3.07867 10.3005 2.20351C9.42531 1.32834 8.23833 0.83667 7.00065 0.83667C5.76297 0.83667 4.57599 1.32834 3.70082 2.20351C2.82565 3.07867 2.33398 4.26566 2.33398 5.50334V6.45267C1.74022 6.71181 1.23485 7.13835 0.87965 7.68014C0.524455 8.22194 0.334837 8.85549 0.333984 9.50334V13.5033C0.335043 14.3871 0.686572 15.2343 1.31146 15.8592C1.93636 16.4841 2.78359 16.8356 3.66732 16.8367H10.334C11.2177 16.8356 12.0649 16.4841 12.6898 15.8592C13.3147 15.2343 13.6663 14.3871 13.6673 13.5033V9.50334C13.6665 8.85549 13.4768 8.22194 13.1217 7.68014C12.7665 7.13835 12.2611 6.71181 11.6673 6.45267ZM3.66732 5.50334C3.66732 4.61928 4.01851 3.77144 4.64363 3.14631C5.26875 2.52119 6.1166 2.17 7.00065 2.17C7.88471 2.17 8.73255 2.52119 9.35767 3.14631C9.9828 3.77144 10.334 4.61928 10.334 5.50334V6.17H3.66732V5.50334ZM12.334 13.5033C12.334 14.0338 12.1233 14.5425 11.7482 14.9176C11.3731 15.2926 10.8644 15.5033 10.334 15.5033H3.66732C3.13689 15.5033 2.62818 15.2926 2.2531 14.9176C1.87803 14.5425 1.66732 14.0338 1.66732 13.5033V9.50334C1.66732 8.9729 1.87803 8.4642 2.2531 8.08912C2.62818 7.71405 3.13689 7.50334 3.66732 7.50334H10.334C10.8644 7.50334 11.3731 7.71405 11.7482 8.08912C12.1233 8.4642 12.334 8.9729 12.334 9.50334V13.5033Z"
        fill="#3B82F6"
      />
    </svg>
  );
};
export const UserIcon: FC<{ scale?: number; fill?: string }> = ({
  scale = 1,
  fill = "#387BE8",
}) => {
  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width={16 * scale}
      height={17 * scale}
      viewBox="0 0 16 17"
      fill="none"
    >
      <g clipPath="url(#clip0_1106_5489)">
        <path
          d="M8 8.6731C8.79113 8.6731 9.56448 8.4385 10.2223 7.99898C10.8801 7.55945 11.3928 6.93474 11.6955 6.20383C11.9983 5.47293 12.0775 4.66866 11.9231 3.89274C11.7688 3.11681 11.3878 2.40408 10.8284 1.84467C10.269 1.28526 9.55629 0.904297 8.78036 0.749956C8.00444 0.595615 7.20017 0.674829 6.46927 0.977579C5.73836 1.28033 5.11365 1.79302 4.67412 2.45082C4.2346 3.10861 4 3.88197 4 4.6731C4.00106 5.73364 4.42283 6.75044 5.17274 7.50036C5.92266 8.25027 6.93946 8.67204 8 8.6731ZM8 2.00643C8.52742 2.00643 9.04299 2.16283 9.48152 2.45585C9.92005 2.74886 10.2618 3.16534 10.4637 3.65261C10.6655 4.13988 10.7183 4.67606 10.6154 5.19334C10.5125 5.71062 10.2586 6.18578 9.88562 6.55872C9.51268 6.93166 9.03752 7.18563 8.52024 7.28853C8.00296 7.39142 7.46678 7.33861 6.97951 7.13678C6.49224 6.93494 6.07577 6.59315 5.78275 6.15462C5.48973 5.71609 5.33333 5.20051 5.33333 4.6731C5.33333 3.96585 5.61428 3.28758 6.11438 2.78748C6.61448 2.28738 7.29276 2.00643 8 2.00643Z"
          fill={fill}
        />
        <path
          d="M8 10.0065C6.40924 10.0082 4.88414 10.6409 3.75931 11.7658C2.63447 12.8906 2.00176 14.4157 2 16.0065C2 16.1833 2.07024 16.3529 2.19526 16.4779C2.32029 16.6029 2.48986 16.6731 2.66667 16.6731C2.84348 16.6731 3.01305 16.6029 3.13807 16.4779C3.2631 16.3529 3.33333 16.1833 3.33333 16.0065C3.33333 14.7688 3.825 13.5818 4.70017 12.7066C5.57534 11.8315 6.76232 11.3398 8 11.3398C9.23768 11.3398 10.4247 11.8315 11.2998 12.7066C12.175 13.5818 12.6667 14.7688 12.6667 16.0065C12.6667 16.1833 12.7369 16.3529 12.8619 16.4779C12.987 16.6029 13.1565 16.6731 13.3333 16.6731C13.5101 16.6731 13.6797 16.6029 13.8047 16.4779C13.9298 16.3529 14 16.1833 14 16.0065C13.9982 14.4157 13.3655 12.8906 12.2407 11.7658C11.1159 10.6409 9.59076 10.0082 8 10.0065Z"
          fill={fill}
        />
      </g>
      <defs>
        <clipPath id="clip0_1106_5489">
          <rect
            width="16"
            height="16"
            fill="white"
            transform="translate(0 0.673096)"
          />
        </clipPath>
      </defs>
    </svg>
  );
};
export const EyeIcon: FC<{ fill: string }> = ({ fill }) => {
  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="16"
      height="17"
      viewBox="0 0 16 17"
      fill="none"
    >
      <g clipPath="url(#clip0_1106_1203)">
        <path
          d="M15.5131 7.11602C14.4791 5.43202 12.1271 2.60669 7.99906 2.60669C3.87106 2.60669 1.51906 5.43202 0.485058 7.11602C0.16541 7.63303 -0.00390625 8.22885 -0.00390625 8.83669C-0.00390625 9.44453 0.16541 10.0404 0.485058 10.5574C1.51906 12.2414 3.87106 15.0667 7.99906 15.0667C12.1271 15.0667 14.4791 12.2414 15.5131 10.5574C15.8327 10.0404 16.002 9.44453 16.002 8.83669C16.002 8.22885 15.8327 7.63303 15.5131 7.11602ZM14.3764 9.85936C13.4884 11.3034 11.4784 13.7334 7.99906 13.7334C4.51972 13.7334 2.50972 11.3034 1.62172 9.85936C1.43181 9.55205 1.33122 9.19794 1.33122 8.83669C1.33122 8.47544 1.43181 8.12133 1.62172 7.81402C2.50972 6.37002 4.51972 3.94002 7.99906 3.94002C11.4784 3.94002 13.4884 6.36736 14.3764 7.81402C14.5663 8.12133 14.6669 8.47544 14.6669 8.83669C14.6669 9.19794 14.5663 9.55205 14.3764 9.85936Z"
          fill={fill}
        />
        <path
          d="M7.99935 5.50317C7.34008 5.50317 6.69561 5.69867 6.14745 6.06494C5.59929 6.43121 5.17204 6.95181 4.91975 7.5609C4.66746 8.16998 4.60145 8.84021 4.73007 9.48681C4.85868 10.1334 5.17615 10.7274 5.64233 11.1935C6.1085 11.6597 6.70245 11.9772 7.34905 12.1058C7.99565 12.2344 8.66587 12.1684 9.27496 11.9161C9.88405 11.6638 10.4046 11.2366 10.7709 10.6884C11.1372 10.1402 11.3327 9.49578 11.3327 8.83651C11.3316 7.95278 10.9801 7.10555 10.3552 6.48065C9.73031 5.85576 8.88308 5.50423 7.99935 5.50317ZM7.99935 10.8365C7.60379 10.8365 7.21711 10.7192 6.88821 10.4994C6.55931 10.2797 6.30297 9.96733 6.15159 9.60187C6.00022 9.23642 5.96061 8.83429 6.03778 8.44633C6.11495 8.05836 6.30543 7.702 6.58514 7.42229C6.86484 7.14259 7.22121 6.95211 7.60917 6.87494C7.99713 6.79777 8.39927 6.83737 8.76472 6.98875C9.13017 7.14012 9.44253 7.39647 9.66229 7.72537C9.88205 8.05427 9.99935 8.44094 9.99935 8.83651C9.99935 9.36694 9.78864 9.87565 9.41356 10.2507C9.03849 10.6258 8.52978 10.8365 7.99935 10.8365Z"
          fill={fill}
        />
      </g>
      <defs>
        <clipPath id="clip0_1106_1203">
          <rect
            width="16"
            height="16"
            fill="white"
            transform="translate(0 0.83667)"
          />
        </clipPath>
      </defs>
    </svg>
  );
};

export default SignUpForm;
